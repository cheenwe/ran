
<!--
program_schedule: 节目排播
program_schedule_search_info: 请搜索节目名称或者频道名称进行选择...
-->
<div class="row">
	<div class="col-md-12">
		<div class="pull-right">
		</div>
		<h3 class="page-title">
			<%= t("program_schedule")%> <small><%= t('program_schedule_search_info')%></small>
		</h3>
		<ul class="page-breadcrumb breadcrumb">
			<li>
				<i class="fa fa-home"></i>
				<a href="/"><%= t('dashboard') %></a>
				<i class="fa fa-angle-right"></i>
			</li>
			<li>
				<a href="/api/v1/schedule"><%= t('program_schedule') %></a>
				<i class="fa fa-angle-right"></i>
			</li>
			<li>
				<a href="/api/v1/schedule?play_date=<%= params["play_date"] %>"><%=   params["play_date"] %></a>
			</li>
		</ul>
	</div>
</div>


<div class="row">
	<div class="col-md-12">
		<div class="col-md-7">
			<div class="panel panel-default">
				<div class="row">
					<div class="col-md-4">
						<div id="sample_1_length" class="dataTables_length">
							<label>
								<select size="1" name="sample_1_length" class="form-control input-xsmall" ng-model="page_size">
									<option value="30" selected="selected">30</option>
									<option value="50">50</option>
									<option value="100">100</option>
									<!-- <option value="-1">All</option> -->
								</select>
							</label>
						</div>
					</div>
					<div class="col-md-8">
						<div class="input-group">
							 <input type="text" id="query" placeholder="请输入频道或者节目名称" class="input-sm form-control" ng-model="query">
							 <span class="input-group-btn">
								<a href="<%= api_v1_schedule_index_url %>?query={{query}}&query_type=channel&page_size={{page_size}}&play_date=<%= params[:play_date]%>" class="btn btn-sm btn-success ">搜索频道名称</a>
								<a href="<%= api_v1_schedule_index_url %>?query={{query}}&query_type=program&page_size=<%= params[:page_size]%>&play_date=<%= params[:play_date]%>" class="btn btn-sm btn-success ">搜索节目名称</a>
							 </span>
						</div>
					</div>
				</div>
				<table id="table-ext-1" class="table table-bordered table-hover">
					<thead>
						<% if  (params[:query_type] == "channel" ||  @channels&&!@channels)&&! @programs %>
							<tr class="bg-gray-light">
								<th data-check-all="data-check-all">
									<div data-toggle="tooltip" data-title="Check All" class="checkbox c-checkbox">
										<label>
											<input type="checkbox" />
											<span class="fa fa-check"></span>
										</label>
									</div>
								</th>
								<th> </th>
								<th><%= t('qingting_id') %></th>
								<th><%= t('qingting_name') %></th>
								<th><%= t('description') %></th>
								<th><%= t('star') %></th>
								<th><%= t('category_name') %></th>
							</tr>
						<% end %>

						<% if  @programs %>

							<tr class="bg-gray-light">
								<th> </th>
								<th> </th>
								<th><%= t('id') %></th>
								<th><%= t('title') %></th>
								<th><%= t('duration') %></th>
								<th>操作</th>

							</tr>
						<% end %>
					</thead>
					<tbody>
					<% if  (params[:query_type] == "channel" ||  @channels&&!@channels)&&! @programs %>
						<% @channels.each do |list| %>
							<tr>
								<td>
								</td>
								<td>
									<div class="media">
										<img src="<%= list["cover"]rescue '' %>" alt="Image" class="img-responsive img-circle" />
									</div>
								</td>
								<td>
									<a href="/api/v1/schedule/?query_type=<%= params[:query_type] %>&channel_id=<%= list["id"] %>&page=1&page_size=<%= params[:page_size]%>&play_date=<%= params[:play_date]%>"><%= list["id"] %></a>
								</td>
								<td><%= list["title"] %></td>
								<td><div  data-toggle="tooltip" data-placement="bottom" title=""  data-original-title="<%= list["description"] rescue'' %>"> description </div></td>
								<td><%= list["star"] %></td>
								<td><%= list["category_name"]  rescue'' %></td>
							</tr>
						<% end %>
					<% end %>

					<% if  @programs %>
						<% @programs.each do |list| %>
							<tr>
								<td>
								</td>
								<td>
									<div class="media">
										<img src="<%= list["cover"] rescue '' %>" alt="Image" class="img-responsive img-circle" />
									</div>
								</td>
								<td>
									<%= list["id"] %>
								</td>
								<td><%= list["title"] %></td>
								<td><%= Time.at(list["duration"]).utc.strftime("%H:%M:%S")   rescue ''  %></td>
								<td>
									<a href="/api/v1/schedule/new?action_type=create&id=<%= list["id"] %>&collect_type=playlist&play_date=<%= params[:play_date]%>" >
										<em  class="fa fa-star-o"></em>
									</a>
								</td>
							</tr>
						<% end %>
					<% end %>
					</tbody>
				</table>

				<div class="panel-footer">
					<div class="row">
						<!-- 分页 -->
						<div class="col-lg-4 pull-right">
							<ul class="pagination  pagination-lg m0 pull-right">
								<li>
									<a href="/api/v1/schedule/?query_type=<%= params[:query_type] %>&channel_id=<%= params["channel_id"]%>&page=<%= params[:page].to_i - 1%>&page_size=<%= params[:page_size]%>&play_date=<%= params[:play_date]%>">
										<span aria-hidden="true"><</span>
									</a>
								</li>
								<li>
									<a href="/api/v1/schedule/?query_type=<%= params[:query_type] %>&channel_id=<%= params["channel_id"]%>&page=<%= params[:page].to_i%>&page_size=<%= params[:page_size]%>&play_date=<%= params[:play_date]%>">
										<span aria-hidden="true"><%= params["page"]%></span>
									</a>
								</li>
								<li>
									<a href="/api/v1/schedule/?query_type=<%= params[:query_type] %>&channel_id=<%= params["channel_id"]%>&page=<%= (params[:page].to_i) +1%>&page_size=<%= params[:page_size]%>&play_date=<%= params[:play_date]%>">
										<span aria-hidden="true">></span>
									</a>
								</li>
							</ul>
						</div>
					</div>
					<!-- 分页结束 -->
				</div>
			</div>
		</div>

		<div class="col-md-5">
			<div class="panel panel-default">
				<div class="panel panel-default">
					<div class="table-responsive">
						<table id="table-ext-1"  class="table table-bordered table-hover">
							<thead>
								<tr class ="bg-gray-light">
									<th><%= t('sequence') %></th>
									<th><%= t('start_at') %></th>
									<th><%= t('title') %></th>
									<th><%= t('duration') %></th>
								<th>操作</th>
								</tr>

							</thead>
							<tbody>

							<ul class="list-group sortable">
								<% @playlists.each do |list| %>

							   		<li class="list-group-item">

							   			<em class="fa fa-reorder fa-fw text-muted mr-lg"></em>
							   			<%= list["sequence"] %> 　｜　<%= list["start_at"] %>　｜　<%= list["title"] %>　｜　<%= Time.at(list["duration"]).utc.strftime("%H:%M:%S")   %>　｜　
											<a href="/api/v1/schedule/new?action_type=remove&id=<%= list["program_id"] %>&collect_type=playlist&play_date=<%= params[:play_date]%>" >
												<em  class="fa fa-remove"></em>
											</a>
										<!-- <tr>
											<td><%= list["sequence"] %></td>
											<td><%= list["start_at"] %></td>
											<td><%= list["title"] %></td>
											<td><%= Time.at(list["duration"]).utc.strftime("%H:%M:%S")  rescue '' %></td>
											<td>

												<a href="/api/v1/schedule/new?action_type=remove&id=<%= list["program_id"] %>&collect_type=playlist&play_date=<%= params[:play_date]%>" >
													<em  class="fa fa-remove"></em>
												</a>

											</td>
										</tr> -->
									</li>
								<% end %>

							</ul>
							</tbody>
						</table>

					</div>
				</div>
			</div>
		</div>

	</div>
</div>